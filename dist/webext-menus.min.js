var webextMenus=function(){"use strict";const n=new Set(["bookmark","browser_action","page_action","tab","tools_menu"]),t=browser.menus||browser.contextMenus;return function(e){const o=new Map,s=[];function i(n){return n.contexts?n.contexts:null!=n.parentId?i(o.get(n.parentId)):["page"]}function c(n){n.id=t.create(n.options),n.isCreated=!0}function r(n){t.remove(n.id),n.isCreated=!1}function a(n){if(n.nextSibling)for(const t of Object.values(n.nextSibling))t.isCreated&&r(t),a(t)}function u(n){if(n.nextSibling)for(const t of Object.values(n.nextSibling))!t.isCreated&&t.show&&c(t),u(t)}return function(t){const e={};for(const a of t){null!=a.id&&o.set(a.id,a),a.options=Object.assign({},a),delete a.options.oncontext,a.oncontext?(s.push(a),a.show=!1):(c(a),a.show=!0);for(const t of r=i(a),r.reduce((t,e)=>(t.add(n.has(e)?e:"webpage"),t),new Set)){e[t]||(e[t]=new Map);const n=e[t].get(a.parentId);n&&(n.nextSibling||(n.nextSibling={}),n.nextSibling[t]=a),e[t].set(a.parentId,a)}}var r}(e),{update:function(){const n=[];for(const t of s){const e=Boolean(t.oncontext());t.show!==e&&(e?(n.push(t),t.show=!0):(r(t),t.show=!1))}for(const t of n)t.isCreated||(a(t),c(t),u(t))}}}}();
//# sourceMappingURL=webext-menus.min.js.map
