var webextMenus=function(){"use strict";const e="undefined"!=typeof browser?browser:chrome,n=e.menus||e.contextMenus,t=new Set(["all","bookmark","browser_action","launcher","page_action","tab","tools_menu"]),o=Object.values(n.ContextType).filter(e=>!t.has(e));return function(e){const t=new Map,c=[],s=[];function i(e){return e.contexts?e.contexts:null!=e.parentId?i(t.get(e.parentId)):["page"]}function r(e){e.id=n.create(Object.assign({},e.options)),e.isCreated=!0}function a(e){n.remove(e.id),e.isCreated=!1}function f(e){if(e.nextSibling)for(const n of Object.values(e.nextSibling))n.isCreated&&a(n),f(n)}function u(e){if(e.nextSibling)for(const n of Object.values(e.nextSibling))!n.isCreated&&n.show&&r(n),u(n)}return function(e){const n={};for(const a of e){null!=a.id&&t.set(a.id,a),a.options=Object.assign({},a),"function"==typeof a.checked&&(delete a.options.checked,s.push(a)),a.oncontext?(delete a.options.oncontext,c.push(a),a.show=!1):(r(a),a.show=!0);for(const e of i(a).reduce((e,n)=>("all"===n?o.forEach(n=>e.add(n)):e.add(n),e),new Set)){n[e]||(n[e]=new Map);const t=n[e].get(a.parentId);t&&(t.nextSibling||(t.nextSibling={}),t.nextSibling[e]=a),n[e].set(a.parentId,a)}}}(e),{update:function(){!function(){const e=[];for(const n of c){const t=Boolean(n.oncontext());n.show!==t&&(t?(e.push(n),n.show=!0):(a(n),n.show=!1))}for(const n of e)n.isCreated||(f(n),r(n),u(n))}(),function(){for(const e of s)n.update(e.id,{checked:e.checked()})}()}}}}();
//# sourceMappingURL=webext-menus.min.js.map
